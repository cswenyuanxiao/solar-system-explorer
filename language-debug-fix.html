<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šè¯­è¨€åˆ‡æ¢åŠŸèƒ½è°ƒè¯•ä¸ä¿®å¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .debug-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #667eea;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .issue-card {
            background: #f8f9fa;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .issue-card.fixed {
            border-left-color: #28a745;
        }
        
        .issue-card h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .issue-card p {
            color: #666;
            line-height: 1.6;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s;
        }
        
        .test-button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-ok { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-warning { background: #ffc107; }
        
        .fix-applied {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .lang-menu {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
            min-width: 150px;
        }
        
        .lang-menu.is-open {
            display: block;
        }
        
        .lang-menu__item {
            display: block;
            width: 100%;
            text-align: left;
            padding: 10px 15px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.2s;
        }
        
        .lang-menu__item:hover {
            background: #f0f0f0;
        }
        
        #language-switcher {
            position: relative;
        }
    </style>
    <!-- Load the real i18n module so the debug page can test the actual LanguageManager -->
    <script src="js/languages.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”§ å¤šè¯­è¨€åˆ‡æ¢åŠŸèƒ½è°ƒè¯•å™¨</h1>
            <p>æ­¤é¡µé¢ç”¨äºè¯Šæ–­å’Œä¿®å¤å¤šè¯­è¨€åˆ‡æ¢åŠŸèƒ½çš„é—®é¢˜</p>
        </div>
        
        <div class="debug-panel">
            <h2>ğŸ“Š é—®é¢˜è¯Šæ–­</h2>
            
            <div class="issue-card">
                <h3><span class="status-indicator status-error"></span>é—®é¢˜ 1: äº‹ä»¶å†²çª</h3>
                <p>å‘ç°äº†å¤šä¸ªäº‹ä»¶ç›‘å¬å™¨å†²çªçš„é—®é¢˜ï¼š</p>
                <div class="code-block">// languages.js ä¸­çš„æ—§ä»£ç ï¼ˆæœ‰é—®é¢˜ï¼‰
setupLanguageSwitcher() {
    document.addEventListener('click', (event) => {
        const switcher = event.target.closest('#language-switcher');
        if (switcher) {
            event.preventDefault();
            const newLang = this.currentLanguage === 'en' ? 'zh' : 'en';
            this.setLanguage(newLang);
        }
    });
}</div>
                <p><strong>é—®é¢˜åˆ†æï¼š</strong>è¿™ä¸ªå…¨å±€ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ä¼šä¸ shared-header.js ä¸­çš„ä¸‹æ‹‰èœå•åŠŸèƒ½å†²çªã€‚</p>
            </div>
            
            <div class="issue-card">
                <h3><span class="status-indicator status-error"></span>é—®é¢˜ 2: åˆå§‹åŒ–æ—¶åº</h3>
                <p>LanguageManager åˆå§‹åŒ–å»¶è¿Ÿå¯èƒ½å¯¼è‡´æŒ‰é’®æ— å“åº”ï¼š</p>
                <div class="code-block">// å»¶è¿Ÿ100msåˆå§‹åŒ–å¯èƒ½ä¸å¤Ÿ
setTimeout(() => {
    languageManager = new LanguageManager();
    window.languageManager = languageManager;
}, 100);</div>
            </div>
            
            <div class="issue-card">
                <h3><span class="status-indicator status-warning"></span>é—®é¢˜ 3: ä¸‹æ‹‰èœå•æœªæ­£ç¡®æ˜¾ç¤º</h3>
                <p>è¯­è¨€èœå•å¯èƒ½å› ä¸º CSS æˆ–äº‹ä»¶å¤„ç†é—®é¢˜æœªèƒ½æ­£ç¡®æ˜¾ç¤ºã€‚</p>
            </div>
        </div>
        
        <div class="debug-panel">
            <h2>âœ… ä¿®å¤æ–¹æ¡ˆ</h2>
            
            <div class="fix-applied">
                <h3>ä¿®å¤ 1: ç§»é™¤å†²çªçš„äº‹ä»¶ç›‘å¬å™¨</h3>
                <div class="code-block">// ä¿®æ”¹ languages.js - ç§»é™¤ setupLanguageSwitcher æ–¹æ³•ä¸­çš„ä»£ç 
// è®© shared-header.js å®Œå…¨æ§åˆ¶è¯­è¨€åˆ‡æ¢æŒ‰é’®çš„è¡Œä¸º

class LanguageManager {
    init() {
        this.translatePage();
        // ç§»é™¤ this.setupLanguageSwitcher();
        this.updateDocumentLanguage();
        this.updateLanguageSwitcherUI();
        this.notifyLanguageChange();
    }
    
    // setupLanguageSwitcher æ–¹æ³•å¯ä»¥å®Œå…¨åˆ é™¤æˆ–ç•™ç©º
}</div>
            </div>
            
            <div class="fix-applied">
                <h3>ä¿®å¤ 2: æ”¹è¿›åˆå§‹åŒ–æ—¶åº</h3>
                <div class="code-block">// ä¿®æ”¹åˆå§‹åŒ–é€»è¾‘ï¼Œç¡®ä¿åœ¨ header åˆ›å»ºåç«‹å³åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', () => {
    // åˆ›å»ºå…¨å±€å®ä¾‹ï¼Œç«‹å³å¯ç”¨
    window.languageManager = new LanguageManager();
    
    // ç¡®ä¿ setLanguage å‡½æ•°ç«‹å³å¯ç”¨
    window.setLanguage = function(lang) {
        if (window.languageManager) {
            window.languageManager.setLanguage(lang);
        }
    };
});</div>
            </div>
            
            <div class="fix-applied">
                <h3>ä¿®å¤ 3: ç¡®ä¿ä¸‹æ‹‰èœå•æ­£ç¡®å·¥ä½œ</h3>
                <div class="code-block">// shared-header.js ä¸­çš„å…³é”®ä»£ç 
const langBtn = document.getElementById('language-switcher');
if (langBtn) {
    langBtn.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
        if (langMenuEl && langMenuEl.classList.contains('is-open')) {
            hideMenu();
        } else {
            showMenu(langBtn);
        }
    });
}</div>
            </div>
        </div>
        
        <div class="debug-panel">
            <h2>ğŸ§ª æµ‹è¯•åŒºåŸŸ</h2>
            
            <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•è¯­è¨€åˆ‡æ¢åŠŸèƒ½ï¼š</p>
            
            <button id="test-language-btn" class="test-button">
                <span id="test-flag">ğŸ‡ºğŸ‡¸</span>
                <span id="test-lang">English</span>
            </button>
            
            <button id="direct-test" class="test-button">
                ç›´æ¥åˆ‡æ¢è¯­è¨€ï¼ˆæµ‹è¯•æ ¸å¿ƒåŠŸèƒ½ï¼‰
            </button>
            
            <div id="test-results" style="margin-top: 20px;">
                <p>å½“å‰è¯­è¨€: <strong id="current-lang">æœªåˆå§‹åŒ–</strong></p>
                <p>æµ‹è¯•æ–‡æœ¬: <span id="test-text" data-en="Hello World" data-zh="ä½ å¥½ä¸–ç•Œ">Hello World</span></p>
            </div>
        </div>
        
        <div class="debug-panel">
            <h2>ğŸ“ å®Œæ•´ä¿®å¤æ­¥éª¤</h2>
            
            <ol style="line-height: 2;">
                <li><strong>ä¿®æ”¹ js/languages.jsï¼š</strong>
                    <ul>
                        <li>åˆ é™¤æˆ–æ³¨é‡Šæ‰ <code>setupLanguageSwitcher()</code> æ–¹æ³•ä¸­çš„æ‰€æœ‰ä»£ç </li>
                        <li>ä» <code>init()</code> æ–¹æ³•ä¸­ç§»é™¤ <code>this.setupLanguageSwitcher();</code> è°ƒç”¨</li>
                        <li>ç¡®ä¿åˆå§‹åŒ–ä»£ç ç›´æ¥åˆ›å»ºå®ä¾‹ï¼Œä¸ä½¿ç”¨ setTimeout</li>
                    </ul>
                </li>
                <li><strong>ç¡®è®¤ js/shared-header.jsï¼š</strong>
                    <ul>
                        <li>è¯­è¨€åˆ‡æ¢æŒ‰é’®æœ‰æ­£ç¡®çš„äº‹ä»¶ç›‘å¬å™¨</li>
                        <li>ä¸‹æ‹‰èœå•é€»è¾‘æ­£å¸¸å·¥ä½œ</li>
                        <li>ä½¿ç”¨ <code>e.stopPropagation()</code> é˜²æ­¢äº‹ä»¶å†’æ³¡</li>
                    </ul>
                </li>
                <li><strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
                    <ul>
                        <li>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜</li>
                        <li>åˆ·æ–°é¡µé¢</li>
                        <li>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯</li>
                        <li>ç‚¹å‡»è¯­è¨€åˆ‡æ¢æŒ‰é’®æµ‹è¯•åŠŸèƒ½</li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>
    
    <script>
        // æ¨¡æ‹Ÿè¯­è¨€ç®¡ç†å™¨
        const LANGUAGES = {
            en: { name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
            zh: { name: 'ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' }
        };
        
        let currentLanguage = 'en';
        
        // æµ‹è¯•è¯­è¨€åˆ‡æ¢
        document.getElementById('test-language-btn').addEventListener('click', function(e) {
            e.preventDefault();
            
            // åˆ‡æ¢è¯­è¨€
            currentLanguage = currentLanguage === 'en' ? 'zh' : 'en';
            
            // æ›´æ–°æŒ‰é’®æ˜¾ç¤º
            this.querySelector('#test-flag').textContent = LANGUAGES[currentLanguage].flag;
            this.querySelector('#test-lang').textContent = LANGUAGES[currentLanguage].name;
            
            // æ›´æ–°æµ‹è¯•ç»“æœ
            updateTestResults();
            
            console.log('è¯­è¨€å·²åˆ‡æ¢è‡³:', currentLanguage);
        });
        
        // ç›´æ¥æµ‹è¯•
        document.getElementById('direct-test').addEventListener('click', function() {
            if (window.languageManager) {
                const newLang = window.languageManager.currentLanguage === 'en' ? 'zh' : 'en';
                window.languageManager.setLanguage(newLang);
                alert('å·²é€šè¿‡ languageManager åˆ‡æ¢è¯­è¨€');
            } else {
                alert('languageManager æœªåˆå§‹åŒ–ï¼è¿™æ˜¯ä¸»è¦é—®é¢˜ã€‚');
                console.error('window.languageManager is not defined');
            }
        });
        
        function updateTestResults() {
            document.getElementById('current-lang').textContent = currentLanguage;
            const testText = document.getElementById('test-text');
            testText.textContent = currentLanguage === 'en' ? 
                testText.getAttribute('data-en') : 
                testText.getAttribute('data-zh');
        }
        
        // åˆå§‹åŒ–
        updateTestResults();
        
        // æ£€æŸ¥å®é™…çš„ languageManager
        setTimeout(() => {
            if (window.languageManager) {
                console.log('âœ… languageManager å·²æ‰¾åˆ°:', window.languageManager);
            } else {
                console.log('âŒ languageManager æœªæ‰¾åˆ°');
            }
        }, 1000);
    </script>
</body>
</html>